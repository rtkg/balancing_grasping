function data=parseBagfile(path)

data = [];

bag = rosbag(path);

ts_r = readMessages(select(bag,'Topic','/ts_r'));
ts_l = readMessages(select(bag,'Topic','/ts_l'));
tf = readMessages(select(bag,'Topic','/tf'));
js = readMessages(select(bag,'Topic','/yumi/joint_states'));


n=size(ts_r,1);
data.ts_r=zeros(n,32);
for i=1:n
   data.ts_r(i,:)=ts_r{i}.Data'; 
end

n=size(ts_l,1);
data.ts_l=zeros(n,32);
for i=1:n
   data.ts_l(i,:)=ts_l{i}.Data'; 
end

n=size(js,1);
data.js.p=zeros(n,16);
data.js.v=zeros(n,16);
data.js.e=zeros(n,16);
data.js.names=js{1}.Name;
for i=1:n
   data.js.p(i,:)=js{i}.Position';
   data.js.v(i,:)=js{i}.Velocity';
   data.js.e(i,:)=js{i}.Effort';
end

n=size(tf,1);
m=size(tf{1}.Transforms);
for i=1:n
   data.tf 
end    

keyboard;